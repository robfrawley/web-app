---

##
## This file is part of the `src-run/web-app` project
##
## (c) Rob Frawley 2nd <rmf@src.run>
##
## For the full copyright and license information, please view the LICENSE.md
## file that was distributed with this source code.
##

build_image: drydock/u14php7all:tip

language:
  - php

php :
  - 7.0

services:
  - memcached

env:

matrix:

build:
  #commands in this section run on your build machine and not inside your CI container.
  pre_ci:

  pre_ci_boot:
    image_name:
    image_tag:
    pull:
    options:
  #commands in this section run inside your CI container. In addition, any commands such as ls, in this section can be used to skip default processing for CI.
  ci:
    - sudo su -c "/usr/local/bin/memcached -d -u nobody -vvv -l 127.0.0.1 -p 11211 &>> /var/log/memcached.log"
    - mkdir -p shippable/testresults
    - mkdir -p shippable/codecoverage
    - phpunit  --log-junit shippable/testresults/junit.xml --coverage-xml shippable/codecoverage tests/MemcachedExampleTest.php

  post_ci:
  on_success:
  on_failure:
  cache:
  #commands in this section run on your build machine and not inside your CI container.
  push:



integrations:
#if you are using integrations, you'll need to set it up in two places. Project settings & here in this section of the yml.
    notifications:
        - integrationName:
          type:
          recipients:
          branches:
          on_start:
          on_success
          on_failure:
          on_changed:

    hub:
        - integrationName:
          type:
          agent_only:
          branches:

...
